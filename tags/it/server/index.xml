<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>IT/Server on Ethan 的思考札记</title><link>https://www.jsongo.top/tags/it/server/</link><description>Recent content in IT/Server on Ethan 的思考札记</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Wed, 18 Dec 2024 00:55:38 +0800</lastBuildDate><atom:link href="https://www.jsongo.top/tags/it/server/index.xml" rel="self" type="application/rss+xml"/><item><title>Cron 表达式</title><link>https://www.jsongo.top/articles/cron-syntax/</link><pubDate>Wed, 18 Dec 2024 00:55:38 +0800</pubDate><guid>https://www.jsongo.top/articles/cron-syntax/</guid><description>&lt;img src="https://cdn.jsongo.top/banners/91668e623e452ebc624daa105d2f82c2.jpg" alt="Featured image of post Cron 表达式" />&lt;p>平时工作中，可能会时不时碰到像 &lt;code>0 */5 * * * *&lt;/code> 这种 Cronjob 定时任务的配置，特别是运维和服务端的同学，经常会打交道。本文只是最基础的用法，后面有新内容再补充，仅作为自己学习、记录、备忘的文档沉淀下。&lt;/p>
&lt;h1 id="基础语法">基础语法
&lt;/h1>&lt;h2 id="cron-表达式的基本格式和含义">Cron 表达式的基本格式和含义
&lt;/h2>&lt;ul>
&lt;li>Cron 表达式用于配置定时任务的执行时间。它由 6 ~ 7 个段组成，从左到右依次是：秒（0 - 59）、分（0 - 59）、时（0 - 23）、日（1 - 31）、月（1 - 12）、周（0 - 6，0 表示周日）。&lt;/li>
&lt;li>上面提到的表达式 &lt;code>0 */5 * * * *&lt;/code> 中，有 6 个字段，一一对号入座就行。&lt;/li>
&lt;li>除了直接写 &lt;code>*&lt;/code>、&lt;code>*/数字&lt;/code> 、&lt;code>数字&lt;/code>，这种写法之外，还有用逗号隔开的写法，如第 4 个位置表示一个月中的哪一日，如果它写成 &lt;code>1,3,5&lt;/code> 表示每个月的 1 日、3 日和 5 日。&lt;/li>
&lt;/ul>
&lt;h2 id="对每个字段的具体分析-">对每个字段的具体分析 **
&lt;/h2>&lt;ul>
&lt;li>&lt;strong>秒（0）&lt;/strong>：表示任务在每分钟的第 0 秒开始执行。&lt;/li>
&lt;li>&lt;strong>分（*/5）&lt;/strong>：&lt;code>*/5&lt;/code> 是一个特殊的语法。在这里，&lt;code>*&lt;/code> 表示 “所有可能的值”，&lt;code>/&lt;/code> 是一个间隔符号。所以 &lt;code>*/5&lt;/code> 表示 “每隔 5 分钟”。也就是说，任务会在 0 分、5 分、10 分、15 分…… 以此类推，每隔 5 分钟执行一次。&lt;/li>
&lt;li>&lt;strong>时（*）&lt;/strong>：&lt;code>*&lt;/code> 表示每一个小时，即任务会在一天中的每一个小时都有可能执行，具体的分钟由前面的 &lt;code>*/5&lt;/code> 决定。&lt;/li>
&lt;li>&lt;strong>日（*）&lt;/strong>：&lt;code>*&lt;/code> 表示一个月中的每一天，即任务在一个月中的每一天都有可能执行。这是第 4 个位置，它有一些特定的语法，如：
&lt;ul>
&lt;li>&lt;code>L&lt;/code>：表示每月的最后一天。&lt;/li>
&lt;li>&lt;code>W&lt;/code>：用于指定最接近给定日期的工作日（周一到周五），如“15W”，它表示最接近 15 日的工作日。&lt;/li>
&lt;li>&lt;code>LW&lt;/code>：合起来，用于指定本月的最后一个工作日。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>月（*）&lt;/strong>：&lt;code>*&lt;/code> 表示每一个月，即任务在每一个月都有可能执行，具体日期由前面的日、时、分决定。&lt;/li>
&lt;li>&lt;strong>周（*）&lt;/strong>：&lt;code>*&lt;/code> 表示每一个周，即任务在每一周都有可能执行，这个比较特殊，也可以省略而只需要前面 5 个也行。&lt;br>
开头说的这个配置，含义是在每分钟的第 0 秒开始，并且每隔 5 分钟执行一次，每天每小时、每月都会按照这个间隔执行。简单说，就是 &lt;strong>5 分钟执行一次&lt;/strong>。&lt;/li>
&lt;/ul>
&lt;div class="admonition summary">
&lt;div class="details-summary admonition-title">
&lt;i class='icon fas fa-pencil-alt fa-fw'>&lt;/i>
简单好记&lt;br
&lt;/div>&lt;/div>
&lt;div class="details-content">
&lt;div class="admonition-content">
&lt;p>一个比较简单的方法来记，就是把 &lt;code>*&lt;/code> 翻译成“&lt;strong>每&lt;/strong>”，把 &lt;code>/&lt;/code> 翻译成“&lt;strong>每隔&lt;/strong>”，非 &lt;code>*&lt;/code> 的则对应地加上时间表达即可。&lt;br>
另一个方法是，从后往前倒着看，比如只看前三个，它就是时间的表达，像 1:00:00&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>&lt;h1 id="使用">使用
&lt;/h1>&lt;p>下面举一些例子，尽量全地覆盖可能用到的场景：&lt;/p>
&lt;ol>
&lt;li>&lt;strong>每 5 秒执行一次&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>*/10 * * * * *&lt;/code>&lt;/li>
&lt;li>解释：在秒的位置上 &lt;code>*/10&lt;/code> 表示每隔 10 秒。上面介绍过这类基础的用法。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>每小时的第 10 分钟执行&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>0 10 * * * *&lt;/code>&lt;/li>
&lt;li>解释：分的位置是 10，秒是 0，表示每小时的第 10 分钟开始时执行。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>每天凌晨 2 点执行&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>0 0 2 * * *&lt;/code>&lt;/li>
&lt;li>解释：时为 2，分和秒为 0，表示每天凌晨 2 点整执行。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>每隔 2 小时执行一次&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>0 0 */2 * * *&lt;/code>&lt;/li>
&lt;li>解释：时的位置 &lt;code>*/2&lt;/code> 表示每隔 2 小时执行。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>每月 1 号凌晨 0 点执行&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>0 0 0 1 * *&lt;/code>&lt;/li>
&lt;li>解释：日为 1，时、分、秒为 0，表示每月 1 号凌晨 0 点执行。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>每周一早上 9 点执行&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>0 0 9 * * 1&lt;/code>&lt;/li>
&lt;li>解释：时为 9，分和秒为 0，周为 1（周一），即每周一早上 9 点执行。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>每月最后一天晚上 11 点 59 分 59 秒执行&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>59 59 23 L * *&lt;/code>&lt;/li>
&lt;li>解释：秒为 59，分是 59，时是 23，日的位置 &lt;code>L&lt;/code> 表示每月最后一天。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>每年 1 月 1 日凌晨 0 点执行&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>0 0 0 1 1 *&lt;/code>&lt;/li>
&lt;li>解释：日为 1，月为 1，时、分、秒为 0，表示每年 1 月 1 日凌晨 0 点执行。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>工作日（周一到周五）早上 8 点执行&lt;/strong>
&lt;ul>
&lt;li>表达式：&lt;code>0 0 8 * * 1-5&lt;/code>&lt;/li>
&lt;li>解释：时为 8，分和秒为 0，周为 1-5，表示周一到周五早上 8 点执行。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol></description></item></channel></rss>